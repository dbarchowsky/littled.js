"undefined"==typeof LITTLED&&(LITTLED={script_root:"/hostmgr/_ajax/",edit_url:"",delete_url:"",view_url:"",cache_url:"",id_param:"id",progress_html:'<div class="dialog-in-process"></div>',debug:!1,init:function(a){if(void 0!==a)for(var b in a)this[b]=a[b]},ajaxError:function(a){var b=$("#globalDialog");b.length>0&&b.is(":visible")&&b.littled("ajaxError",a)},displayStatus:function(a){a&&$("#status-container").length&&($("#status-container").html(LITTLED.htmldecode(a).replace(/\n/g,"<br />\n")),$("#status-container:hidden").fadeIn("slow"))},doLookup:function(){var a=document.getElementById("dialog-edit-form");return a.url.value?(LITTLED.displayProcessWheel(),$("#dialog-edit-form").ajaxSubmit({url:a.url.value,type:"post",dataType:"json",success:LITTLED.onLoadFormSuccess,error:LITTLED.ajaxError}),!1):(alert("url not set!"),!1)},updateCache:function(){$.littled.updateCache()},getParentObject:function(a){var b;return void 0===a?b=$("body"):"object"==typeof a?b=a:(b=$(a),b.length<1&&(b=$("body"))),b},oc:function(a){for(var b={},c=0;c<a.length;c++)b[a[c]]="";return b},ptq:function(a,b){var c,d,e,f=a.replace(/;/g,"&").split("&");for(a={},c=0;c<f.length;c++)e=f[c].split("=",2),d=unescape(e[0]),void 0!==b&&b.length>=0&&d in LITTLED.oc(b)&&(d=""),""!=d&&(a[d]||e.length>1&&(a[d]=unescape(e[1])));return a},getQueryArray:function(a,b){var c=["id","msg"];void 0!==b&&b.length>=0&&(c=c.concat(b));var d=LITTLED.ptq(document.location.search.substring(1).replace(/\+/g," "),c);for(var e in d)""==d[e]&&delete d[e];if(void 0!==a&&"object"==typeof a)for(e in a)d[e]=a[e];return d},getParameterByName:function(a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var b="[\\?&]"+a+"=([^&#]*)",c=new RegExp(b),d=c.exec(window.location.href);return null==d?"":decodeURIComponent(d[1].replace(/\+/g," "))},isObjectEmpty:function(a){for(var b in a)if(Object.prototype.hasOwnProperty.call(a,b))return!1;return!0},getDomain:function(){return void 0===window.document.domain?window.document.hostname:window.document.domain},bindImageRollovers:function(){$("img.ro").hover(function(){$(this).attr("src",$(this).attr("src").replace(/\.([^.]+)$/,"-over.$1"))},function(){$(this).attr("src",$(this).attr("src").replace(/-over\.([^.]+)$/,".$1"))})},edit_cb:function(a){LITTLED.onEditSuccess(a)},onEditSuccess:function(a){if(LITTLED.clearDialogMsg(),a.error)return LITTLED.displayError(a.error.replace("/\n/mg","<br />\n"),"dialog-error-container");if(a.container_id){var b=$("#"+a.container_id);b.length<1&&(b=$("#listings-container"))}else b=$("#listings-container");return b.length&&(b.html(LITTLED.htmldecode(a.content)),LITTLED.setSortables()),LITTLED.displayStatus(a.status),LITTLED.dismissDialog(),!1},setSortables:function(){},onContentUpdate:function(a){return a.error?LITTLED.displayError(LITTLED.htmldecode(a.error)):($("#"+a.container_id).html(LITTLED.htmldecode(a.content)),!1)},displayAjaxResult:function(a){if(a.error){var b=null;if(void 0!==a.container_id&&""!=a.container_id)b=$("#"+a.container_id),b.html('<div class="error">'+a.error.replace(/\n/gm,"<br />")+"</div>");else{if(!$("#error-container").length)return alert(a.error),!1;b=$("#error-container"),b.html(a.error.replace(/\n/gm,"<br />"))}return b.show(),!1}return $("#"+a.container_id).html(LITTLED.htmldecode(a.content)),$("#"+a.container_id).show(),!1},onLoadFormSuccess:function(a){return LITTLED.clearDialogMsg(),a.error?LITTLED.displayError(a.error):($("#global-modal-content").html(LITTLED.htmldecode(a.content)),$("#globalDialog").dialog({title:a.label,minWidth:360,width:"auto",height:"auto",modal:!0}),$("#globalDialog .datepicker").datepicker(),$("#globalDialog .dlg-commit-btn").button().on("click",LITTLED.commitOp),$("#globalDialog .dlg-cancel-btn").button().on("click",LITTLED.cancel),!1)},commitOp:function(){var a=$(this).data("tid"),b=$(this).data("op");return a?b?(LITTLED.execSectionOp(a,function(a){if(a.error)return LITTLED.displayError(a.error,"dialog-error-container");var c="";switch(b){case"edit":c=a.edit_uri;break;case"delete":c=a.delete_uri;break;default:return LITTLED.displayError("Unhandled operation."),!1}return""==c?(alert("Handler not set."),!1):(c=$.littled.addProtocolAndDomain(c),$("#dialog-edit-form").ajaxSubmit({url:c,type:"post",dataType:"json",success:LITTLED.edit_cb,error:LITTLED.ajaxError}),!1)}),!1):LITTLED.displayError("Operation not specified."):LITTLED.displayError("Content type not specified.")},dialogEdit:function(a,b,c){var d,e,f,g=LITTLED.onLoadFormSuccess;return"function"==typeof a?(g=a,f=b,e=f.data("tid")):("object"==typeof a||"undefined"==typeof a||"null"==typeof a)&&(f=$(this),d=f.data("id"),e=void 0===b?f.data("tid"):b),void 0===c&&(c=f.data("op")),void 0===e?LITTLED.displayError("Content type not set."):void 0===c?LITTLED.displayError("Operation not set."):(LITTLED.execSectionOp(e,function(a){if(a.error)return LITTLED.displayError(a.error);var b=LITTLED.getOperationURI(c,a);if(!b)return LITTLED.displayError("Unsupported operation.");LITTLED.initDialog();var f={tid:e};return f[a.id_param]=d,f=LITTLED.getQueryArray(f),$.ajax({method:"get",url:b,data:f,dataType:"json",success:g,error:LITTLED.ajaxError}),!1}),!1)},cancel:function(a){"undefined"!=typeof LITTLED.Video&&LITTLED.Video.unhideFLV(a),LITTLED.dismissDialog()},initDialog:function(){"undefined"!=typeof LITTLED.Video&&LITTLED.Video.hideFLV(),$("#dialog-bg").height($(document).height()),$("#dialog-bg").width($(document).width());var a=$(document).scrollTop();$("#dialog-bg").offset({top:a,left:0}),$("#dialog-bg").show(),$("#dialog-error-container").hide(),$("#dialog-status-container").hide(),$("#dialog-form-container").html(LITTLED.progress_html),$("#dialog-container").show(),LITTLED.center($("#dialog-container"))},dismissDialog:function(){"undefined"!=typeof LITTLED.Video&&LITTLED.Video.unhideFLV(),$("#globalDialog").dialog("close")},clearDialogMsg:function(){$("#dialog-status-container").hide(),$("#dialog-error-container").hide()},execSectionOp:function(a,b){$.ajax({type:"get",url:LITTLED.script_root+"utils/script_properties.php",dataType:"json",data:{tid:a},success:b,error:LITTLED.ajaxError})},getOperationURI:function(a,b){switch(a){case"edit":return b.edit_uri;case"delete":return b.delete_uri;case"view":return b.details_uri;default:return""}},displayProcessWheel:function(a){void 0===a&&(a="dialog"),$("#"+a+"-error-container").html(""),$("#"+a+"-error-container").hide(),$("#"+a+"-status-container").html(LITTLED.progress_html),$("#"+a+"-status-container").show()},center:function(a){var b=$(document).scrollTop()+$(window).height()/2-a.height()/2,c=$(window).width()/2-a.width()/2;a.offset({top:b,left:c})},formatQueryString:function(){var a=document.location.search.toString();return a=a.replace(/^[\?]/,"&"),a=a.replace(new RegExp("&(id|msg|"+LITTLED.id_param+")=.*?&"),"&"),a=a.replace(new RegExp("&(id|msg|"+LITTLED.id_param+")=.*$"),""),a=a.replace(/^[\?&]/,"")},htmldecode:function(a){return void 0===a?"":a.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"')},displayError:function(a,b){var c=void 0!==b&&b?$("#"+b):$("#error-container");return c.length&&c.littled("displayError",a),!1},dismissError:function(a){var b=void 0!==a&&a?$("#"+a):$("#error-container");b.length&&b.is(":visible")&&b.slideToggle("slow")},dialogError:function(a,b){var c=$("#"+(void 0!==b&&b?b:"dialog")+"-status-container");if(c.length<1&&(c=$("#status-container")),"dialog-status-container"===c.attr("id")&&$("#dialog-container").is(":hidden")&&(c=$("#status-container")),c.length&&c.hide(),c=$("#"+(void 0!==b&&b?b:"dialog")+"-error-container"),c.length<1&&(c=$("#error-container")),"dialog-error-container"===c.attr("id")&&$("#dialog-container").is(":hidden")&&(c=$("#error-container")),c.length){c.html(a.replace(/\n/gm,"<br />")),b||c.html(c.html()+' <input class="smtext" type="button" value="close" onclick="LITTLED.cancel()" />'),c.show();var d=parseInt(c.parent().css("z-index"));d>0&&LITTLED.center(c.parent())}},bindInlineTB:function(){$("input.tbi").each(function(){""===$(this).val()&&$(this).val($(this).data("init"))}),$("input.tbi").on("focus",function(){$(this).val()===$(this).data("init")&&$(this).val("")}).on("blur",function(){""===$(this).val()&&$(this).val($(this).data("init"))})},setInputLabel:function(a,b){a.length<1||(a.focus(function(){$(this).val()===b&&($(this).val(""),$(this).removeClass("dimtext"))}).blur(function(){""===$(this).val()&&($(this).val(b),$(this).addClass("dimtext"))}),a.val()||(a.val(b),a.addClass("dimtext")))},onHTTPFailure:function(a){LITTLED.ajaxError(a)}}),function(a){var b={errorContainer:".alert-error",statusContainer:".alert-info",csrfSelector:"#csrf-token",progress_markup:'<div class="dialog-in-process"></div>',ajax:{content_operations_uri:"_ajax/utils/script_properties.php"},dom:{page_error_container:".alert-error:first"}};a.fn.serializeObject=function(b,c){var d={};return this.each(function(){a.each(a(this).serializeArray(),function(a,b){b.name in d?d[b.name]instanceof Array?d[b.name].push(b.value):d[b.name]=[d[b.name],b.value]:d[b.name]=b.value}),"undefined"!=typeof c&&a.each(c,function(a,b){b in d&&delete d[b]}),d=a.extend({},d,b||{})}),d},a.fn.setTextboxMessage=function(a){this.littled("setTextboxMessage",a)},a.fn.iconButton=function(a){return this.button({icons:{primary:"ui-icon-"+a},text:!1})},a.fn.allData=function(){var b=jQuery.data(this.get(0));return a.cache[b]},a.littled={getDomain:function(){return void 0===window.document.domain?window.document.hostname:window.document.domain},getRelativePath:function(){var a="",b=window.location.href;if(b=b.replace(/^.*:\/\/.*?\/(.*\/).*$/,"$1"))for(var c=b.split("/").length-1,d=0;c>d;d++)a+="../";return a},addProtocolAndDomain:function(b){return location.protocol+"//"+a.littled.getDomain()+b},htmldecode:function(a){return void 0===a?"":a.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"')},htmlentities:function(a){return String(a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},getQueryArray:function(a,b){var c=["id","msg"];void 0!==b&&b.length>=0&&(c=c.concat(b));var d=LITTLED.ptq(document.location.search.substring(1).replace(/\+/g," "),c);for(var e in d)""===d[e]&&delete d[e];if(void 0!==a&&"object"==typeof a)for(e in a)d[e]=a[e];return d},getEventOptions:function(b,c){var d=c||{};return b.hasOwnProperty("data")&&void 0!==b.data&&b.data.hasOwnProperty("options")&&a.extend(d,b.data.options),d},retrieveContentOperations:function(c,d,e){var f=a.extend(!0,{},b,e||{}),g={};g.tid=c,g.csrf=a(f.csrfSelector).html(),a.ajax({type:"post",url:a.littled.getRelativePath()+f.ajax.content_operations_uri,dataType:"json",data:g,success:d}).fail(function(b){a(f.dom.page_error_container).littled("ajaxError",b)})},updateCache:function(c){c.preventDefault();var d=a.extend(!0,{},b,c.data||{});a(d.errorContainer+":visible").fadeOut("fast"),a(d.statusContainer+":visible").fadeOut("fast");var e=a(this).data("tid"),f=a(this).data("id");return e?(a.littled.retrieveContentOperations(e,function(b){return b.error?(a(d.errorContainer).littled("displayError",b.error),void 0):b.cache_uri?(a.post(b.cache_uri,{tid:e,id:f,csrf:a(d.csrfSelector).html()},function(b){return b.error?(a(d.errorContainer).littled("displayError",b.error),void 0):(a(d.statusContainer).littled("displayStatus",b.status),void 0)},"json").fail(function(b,c,e){a(d.errorContainer).littled("displayError",c+": "+e.message)}),void 0):(a(d.errorContainer).littled("displayError","Cache handler not set."),void 0)},d),void 0):(a(d.errorContainer).littled("displayError","Content type not specified."),void 0)}};var c={displayAjaxResult:function(b){return this.each(function(){if(b.error){var c=a(".error",a(this));c.length>0?c.html(b.error).show():a(this).html(b.error).addClass("error")}else a(this).html(a.littled.htmldecode(b.content)).show()})},displayError:function(b){return b=b.replace(/\n/gm,"<br />").replace(/<br \/>$/,""),b+='<br /><button class="dismiss-btn smtext">dismiss</button>',this.html(b).show("slow"),this.each(function(){var b=a(this);a("button.dismiss-btn",a(this)).click(function(){a(this).unbind("click"),b.hide("fast")})})},ajaxError:function(b){return"200"===b.status?this.little("displayError",a.littled.htmlentities(b.responseText)):this.littled("displayError","["+b.status+" "+b.statusText+"] "+b.responseText)},displayStatus:function(b){return this.each(function(){b&&a(this).show("slow").html(a.littled.htmldecode(b).replace(/\n/g,"<br />\n"))})},dismissError:function(){a(this).html("").hide("fast")},collectFormDataWithCSRF:function(b,c){var d=a.extend({},{csrf:a(b.csrfSelector).html()},c||{});return a.extend(d,a("input, select, textarea",this).serializeObject())},keyNavigation:function(a){return this.on("keydown",function(b){var c=b.keyCode||b.which,d={left:37,up:38,right:39,down:40};switch(c){case d.left:a.backURL&&(b.preventDefault(),window.location=a.backURL);break;case d.right:a.nextURL&&(b.preventDefault(),window.location=a.nextURL);break;case d.up:a.upURL&&(b.preventDefault(),window.location=a.upURL);break;case d.down:a.downURL&&(b.preventDefault(),window.location=a.downURL)}})},setTextboxMessage:function(b){return this.each(function(){""===a(this).val()&&a(this).val(b).addClass("dimtext"),a(this).blur(function(){""===a(this).val()&&a(this).val(b).addClass("dimtext")}).focus(function(){a(this).val()===b&&a(this).val("").removeClass("dimtext")})})},bindImageRollovers:function(){return this.on("mouseenter",function(){a(this).prop("src",a(this).prop("src").replace(/\.([^.]+)$/,"-over.$1"))}).on("mouseleave",function(){a(this).prop("src",a(this).prop("src").replace(/-over\.([^.]+)$/,".$1"))})},displayProcessWheel:function(){return this.each(function(){var c=a(this).closest("form");a(".error",c).html("").hide("fast"),a(".status",c).html(b.progress_markup).show()})},formatQueryString:function(){var a=document.location.search.toString();return a=a.replace(/^[\?]/,"&"),a=a.replace(new RegExp("&(id|msg|"+LITTLED.id_param+")=.*?&"),"&"),a=a.replace(new RegExp("&(id|msg|"+LITTLED.id_param+")=.*$"),""),a=a.replace(/^[\?&]/,"")},testAndAddElement:function(b,c,d){return this.each(function(){var e=null;if(c&&!c instanceof Array){if(e=a(this).closest(c),e.length<1)return}else c instanceof Array&&(d=c),e=a(this);var f=e.first(b);if(f.length<1){var g="<div></div>";if(0===b.indexOf("#"))g.addClass(b).substr(1);else{if(0!==b.indexOf("."))return;g.attr("id",b.substr(1))}if(d instanceof Array)for(var h in d)g.addClass(h);e.prepend(g)}})}};a.fn.littled=function(b){return c[b]?c[b].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof b&&b?(a.error("Method "+b+" does not exist on jQuery.littled"),void 0):c.init.apply(this,arguments)}}(jQuery),function(a){var b={event:"click",width:"auto",height:"auto",dialogClass:"",formLoadCB:null,formDismissCB:null,preContentUpdateCB:null,postContentUpdateCB:null,pagesContainer:".pages-container",dialogSelector:"#globalDialog",errorContainer:"#globalDialog .alert-error:first",pageErrorContainer:".alert-error:first",listingsContainer:".listings",navigationContainer:".page-links-container",filtersSelector:".listings-filters form",csrfSelector:"#csrf-token",displayWarnings:!0,keys:{record_id:"id",content_type_id:"tid",parent_id:"pid",operation:"op",page:"p",commit:"commit",cancel:"cancel",csrf:"csrf"},dom:{dialog_container:"#globalDialog",listings_container:".listings",listings_filters:".listings-filters form",dialog_error_container:"#globalDialog .alert-error:first",page_error_container:".alert-error:first",error_container:".alert-error",status_container:".alert-info:first"},callbacks:{update_content:null}},c={init:function(d){var e=a.extend(!0,{},b,d||{});return this.off(e.event,c.open).on(e.event,d,c.open)},cancel:function(d){var e=a.extend(!0,{},b,d||{});return this.off(e.event,c.open)},open:function(d){d.preventDefault();var e=d.data||{},f=a.extend(!0,{},b,e);c.dismissErrorMessages(e);var g={};if(g[f.keys.operation]=f.hasOwnProperty("scriptData")&&f.scriptData.hasOwnProperty(f.keys.operation)?f.scriptData.op:a(this).data("op"),g[f.keys.record_id]=f.hasOwnProperty("scriptData")&&f.scriptData.hasOwnProperty(f.keys.record_id)?f.scriptData.id:a(this).data("id"),g[f.keys.content_type_id]=f.hasOwnProperty("scriptData")&&f.scriptData.hasOwnProperty(f.keys.content_type_id)?f.scriptData.tid:a(this).data("tid"),g.ssid=g[f.keys.content_type_id],g[f.keys.parent_id]=f.hasOwnProperty("scriptData")&&f.scriptData.hasOwnProperty(f.keys.parent_id)?f.scriptData.pid:a(this).data("pid"),g[f.keys.page]=a(f.dom.listings_container+" table:first").data(f.keys.page),g[f.keys.csrf]=a(f.csrfSelector).html(),void 0===g[f.keys.operation])return a(f.dom.page_error_container).littled("displayError","Operation not specified."),void 0;if(void 0===g[f.keys.content_type_id])return a(f.dom.page_error_container).littled("displayError","Content type not specified."),void 0;a(this);a.littled.retrieveContentOperations(g[f.keys.content_type_id],function(b){if(b.error)return a(f.dom.page_error_container).littled("displayError",b.error),void 0;var d=c.getOperationURI(g[f.keys.operation],b);if(!d)return a(f.dom.page_error_container).littled("displayError","Operation handler not specified."),void 0;g[b.id_param]=g[f.keys.record_id],a.extend(g,f.scriptData||{});var h=a(f.dom.listings_filters).formDialog("retrieveFormFilters",e);_.size(h)>0?a.extend(h,g):h=a.littled.getQueryArray(g),delete h.commit,a.ajax({type:"post",url:d,data:h,dataType:"json"}).success(function(b){b.settings=e,a(f.dom.dialog_container).formDialog("display",b)}).fail(function(b){a(f.dom.page_error_container).littled("ajaxError",b)})})},display:function(c){var d=a.extend(!0,{},b,c.settings||{});return c.error?(a(d.dom.page_error_container).littled("displayError",c.error),!1):this.each(function(){a("#global-modal-content").html(a.littled.htmldecode(c.content)),a(this).dialog({title:c.label,minWidth:360,width:d.width,height:d.height,dialogClass:d.dialogClass,closeOnEscape:!0,modal:!0,open:function(){a(".ui-widget-overlay").click(function(b){b.preventDefault(),a(d.dom.dialog_container).formDialog("close")}),a(this).formDialog("bindDialogHandlers",c.settings),d.formLoadCB&&d.formLoadCB.apply(this,Array.prototype.slice.call(arguments,1))},close:function(){a(".ui-widget-overlay").unbind("click")}})})},bindDialogHandlers:function(d){var e=a.extend(!0,{},b,d||{});return this.each(function(){a(".datepicker",a(this)).datepicker(),a(".dlg-commit-btn",a(this)).button().on("click",d,c.commitOperation),a(".dlg-cancel-btn",a(this)).button().on("click",d,function(b){b.preventDefault(),a(e.dom.dialog_container).formDialog("close")})})},collectValue:function(b,c){var d=a(this).data(b);if(!d&&("object"!=typeof c&&(c=a(this).closest("form")),c.length)){var e=a('input[name="'+b+'"]',c);e.length&&(d=e.val())}return d},commitOperation:function(d){d.preventDefault();var e=d.data||{},f=a.extend(!0,{},b,e);c.dismissErrorMessages(e);var g=a(this).closest("form"),h=a(this).formDialog("collectValue",f.keys.content_type_id,g),i=a(this).formDialog("collectValue",f.keys.operation,g);return h?i?(a.littled.retrieveContentOperations(h,function(b){if(b.error)return c.displayError(b.error,e),void 0;var d=c.getOperationURI(i,b);return d?(d=a.littled.addProtocolAndDomain(d),f.preContentUpdateCB&&f.preContentUpdateCB.apply(this,Array.prototype.slice.call(arguments,1)),g.ajaxSubmit({url:d,type:"post",dataType:"json",success:function(a){return null===a?(c.displayError("No data returned.",e),void 0):(a.settings=e,c.onOperationSuccess(a),void 0)},error:c.ajaxError}),void 0):(c.displayError("Invalid operation.",e),void 0)}),void 0):(c.displayError("Operation not specified.",e),void 0):(c.displayError("Content type not specified.",e),void 0)},onOperationSuccess:function(d){var e=d.settings||{},f=a.extend(!0,{},b,e);return c.dismissErrorMessages(e),d.error?(a(f.dom.dialog_error_container).littled("displayError",d.error),void 0):(d.settings=e,"function"==typeof f.callbacks.update_content?f.callbacks.update_content.apply(this,Array.prototype.slice.call(arguments)):a(f.dom.listings_container).listings("updateListingsContent",d),f.postContentUpdateCB&&f.postContentUpdateCB.apply(this,arguments),a(f.dom.dialog_container).formDialog("close",e),void 0)},close:function(){return this.each(function(){a(this).dialog("close")})},dismissErrorMessages:function(c){var d=a.extend(!0,{},b,c||{});a(d.dom.error_container+":visible").hide("fast"),a(d.dom.page_error_container+":visible").hide("fast"),a(d.dom.dialog_error_container+":visible").hide("fast")},clearPageContent:function(c){var d=a.extend(!0,{},b,c.settings||{});return this.each(function(){return c.error?(a(d.dom.page_error_container).littled("displayError",c.error),void 0):(a(this).html("<div><!-- --></div>"),a(d.dom.status_container).littled("displayStatus",c.status),void 0)})},retrieveFormFilters:function(c){var d=a.extend(!0,{},b,c||{}),e={};return this.each(function(){e=a(this).serializeObject(),a.extend(e,{id:a(this).data("id"),pid:a(this).data(d.keys.parent_id),tid:a(this).data(d.keys.content_type_id),p:a(d.dom.listings_container+" table:first").data(d.keys.page)})}),e},retrieveContentOperations:function(b,c,d){a.littled.retrieveContentOperations(b,c,d)},clearMessages:function(){return this.each(function(){a(".message",a(this)).html("").hide("fast"),a(".error",a(this)).html("").hide("fast")})},getOperationURI:function(a,b){switch(a){case"edit":return b.edit_uri;case"upload":return b.upload_uri?b.upload_uri:b.edit_uri;case"delete":return b.delete_uri;case"view":case"details":return b.details_uri;default:return""}},ajaxError:function(a){var b="["+a.status+" "+a.statusText+"] "+a.responseText;c.displayError(b)},displayError:function(c,d){var e=a.extend(!0,{},b,d||{});a(e.dom.dialog_container).is(":visible")?a(e.dom.dialog_error_container).littled("displayError",c):a(e.dom.page_error_container).littled("displayError",c)}};a.fn.formDialog=function(b){return c[b]?c[b].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof b&&b?(a.error("Method "+b+" does not exist on jQuery.formDialog"),void 0):c.init.apply(this,arguments)}}(jQuery),function(a){var b={edit_uri:"",input_key:"",events:{to_edit:"dblclick",to_commit:"change"},dom:{edit_container:".inline-edit",status_container:".alert-info",page_error_container:".alert-error:first",error_container:".alert-error",csrf_container:"#csrf-token"}},c={init:function(d){var e=a.extend({},b,d||{});return this.each(function(){a(this).off(e.events.to_edit,c.edit).on(e.events.to_edit,d,c.edit)})},edit:function(d){d.preventDefault();var e=d.data,f=a.extend(!0,{},b,e||{}),g=a(this),h={id:a(this).attr("data-id"),csrf:a(f.dom.csrf_container).html()};a.ajax({type:"post",url:f.edit_uri,data:h,dataType:"json"}).success(function(b){if(b.error)return a(f.dom.error_container,g).littled("displayError",b.error),void 0;switch(g.html(a.littled.htmldecode(b.content)),f.events.to_commit){case"change":a("select[name="+f.input_key+"]").on("change",e,c.commitEdit);break;case"key":break;default:a(f.dom.page_error_container).littled("displayError","Unhandled event.")}}).fail(function(b,c,d){a(f.dom.page_error_container).littled("displayError",c+": "+d.message)})},commitEdit:function(c){c.preventDefault();var d=a.extend(!0,{},b,c.data||{}),e=a(this).closest("form").serializeObject();a.extend(e,{csrf:a(d.dom.csrf_container).html()});var f=a(this);a.ajax({type:"post",url:d.edit_uri,data:e,dataType:"json"}).success(function(a){f.closest(d.dom.edit_container).littled("displayAjaxResult",a)}).fail(function(b,c,e){a(d.dom.page_error_container).littled("displayError",c+": "+e.message)})}};a.fn.inlineEdit=function(b){if("extendMethods"===b)a.extend(!0,c,arguments[1]);else{if(c[b])return c[b].apply(this,Array.prototype.slice.call(arguments,1));if("object"==typeof b||!b)return c.init.apply(this,arguments);a.error("Method "+b+" does not exist on jQuery.inlineEdit.")}return!1}}(jQuery),function(a){var b={parentSelector:".line-items-container",lineSelector:".line-item",statusSelector:".alert-info",errorSelector:".alert-error",emptySetSelector:".empty-set",csrfSelector:"#csrf-token",insertLocation:"before",commitParam:"commit",cancelParam:"cancel",currentOperation:"edit",add:{selector:".add-line-btn",event:"click",button:"plus",callback:null,verbose:!1,uri:a.littled.addProtocolAndDomain("/_ajax/utils/edit_line_item.php")},edit:{selector:".line-item",event:"dblclick",button:"",callback:null,verbose:!1,uri:a.littled.addProtocolAndDomain("/_ajax/utils/edit_line_item.php")},del:{selector:".delete-line-btn",event:"click",button:"trash",callback:null,verbose:!0,uri:a.littled.addProtocolAndDomain("/_ajax/utils/delete_line_item.php")},save:{selector:".save-line-btn",event:"click",button:"circle-check",callback:null,verbose:!1,uri:a.littled.addProtocolAndDomain("/_ajax/utils/edit_line_item.php")},cancel:{selector:".cancel-line-btn",event:"click",button:"circle-close",callback:null,verbose:!1,uri:a.littled.addProtocolAndDomain("/_ajax/utils/edit_line_item.php")},callbacks:{postContentInsert:null}},c={init:function(d){var e=a.extend({},b,d||{});return"function"!=typeof e.add.callback&&(e.add.callback=c.edit),"function"!=typeof e.edit.callback&&(e.edit.callback=c.edit),"function"!=typeof e.del.callback&&(e.del.callback=c.remove),"function"!=typeof e.save.callback&&(e.save.callback=c.save),"function"!=typeof e.cancel.callback&&(e.cancel.callback=c.cancel),this.each(function(){a(this).off(e.add.event,e.add.selector,e.add.callback).off(e.edit.event,e.edit.selector,e.edit.callback).on(e.add.event,e.add.selector,d,e.add.callback).on(e.edit.event,e.edit.selector,d,e.edit.callback),"click"===e.add.event&&a(e.add.selector,a(this)).iconButton(e.add.button),"click"===e.edit.event&&a(e.edit.selector,a(this)).iconButton(e.edit.button),"click"===e.del.event&&a(e.del.selector,a(this)).iconButton(e.del.button),e.hasOwnProperty("postInit")&&a(this).lineitems(e.postInit)})},edit:function(c){c.preventDefault();var d=c.data||{},e=a.extend(!0,{},b,d),f=a(this);f.lineitems("resetMessages",e);var g={id:a(this).data("id"),pid:a(this).data("pid"),"class":a(this).data("type"),"var":a(this).data("var"),csrf:a(e.csrfSelector).html()};a.ajax({type:"post",url:e.edit.uri,data:g,dataType:"json"}).success(function(a){a.settings=d,f.lineitems("insertEditFormMarkup",a)}).fail(function(a,b,c){f.lineitems("displayError",b+": "+c.message)})},remove:function(c){c.preventDefault();var d=c.data||{},e=a.extend(!0,{},b,d);e.currentOperation="delete";var f=a(this).closest(e.lineSelector);f.lineitems("resetMessages",e);var g=a(this).closest("form").littled("collectFormDataWithCSRF",e);g.hasOwnProperty(e.commitParam)&&delete g[e.commitParam],a.ajax({type:"post",url:e.del.uri,data:g,dataType:"json"}).success(function(a){a.settings=d,a.settings.currentOperation="delete",f.lineitems("insertEditFormMarkup",a)}).fail(function(a,b,c){f.lineitems("displayError",b+": "+c.message)})},save:function(c){c.preventDefault();var d=a.extend({},b,c.data||{}),e=a(this).closest(d.lineSelector);e.lineitems("resetMessages",d);a.post(d.save.uri,e.littled("collectFormDataWithCSRF",d),function(a){a.settings=d,e.lineitems("insertLineItemMarkup",a)},"json").fail(function(a,b,c){e.lineitems("displayError",b+": "+c.message)})},commitDelete:function(c){c.preventDefault();var d=a.extend({},b,c.data||{}),e=a(this).closest(d.lineSelector);e.lineitems("resetMessages",d);var f=e.littled("collectFormDataWithCSRF",d);a.ajax({type:"post",url:d.del.uri,data:f,dataType:"json"}).success(function(b){return b.error?(e.lineitems("displayError",b.error,d),void 0):(e.length>0&&e.slideToggle("fast",function(){a(this).remove()}),b.status&&d.del.verbose&&e.lineitems("displayStatus",b.status,d),void 0)}).fail(function(a,b,c){e.lineitems("displayError",b+": "+c.message)})},cancel:function(c){c.preventDefault();var d=a.extend({},b,c.data||{}),e=a(this).closest(".line-item");e.lineitems("resetMessages",d);var f=e.littled("collectFormDataWithCSRF",d,{cancel:"1"});f.hasOwnProperty(d.commitParam)&&delete f[d.commitParam];a.post(d.cancel.uri,f,function(a){a.settings=d,e.lineitems("insertLineItemMarkup",a)},"json").fail(function(a,b,c){e.lineitems("displayError",b+": "+c.message)})},insertLineItemMarkup:function(c){var d=c.settings||b;return c.error?(this.lineitems("displayError",c.error),void 0):this.each(function(){var b=a(a.littled.htmldecode(c.content));if(b.length>0){a(this).fadeOut("fast",function(){a(this).replaceWith(b),b.fadeIn("slow")});var e=b.closest(d.parentSelector);e.lineitems("bindNewItemHandlers",d),a(d.emptySetSelector,e).remove(),c.status&&d.save.verbose&&e.lineitems("displayStatus",c.status)}else a(this).fadeOut("fast",function(){a(this).remove()})})},insertEditFormMarkup:function(c){var d=a.extend(!0,{},b,c.settings||{});return c.error?(this.lineitems("displayError",c.error),void 0):this.each(function(){var b=a(a.littled.htmldecode(c.content));if(b.length){if(c.id)a(this).fadeOut("fast",function(){a(this).replaceWith(b),b.fadeIn("slow")});else{var e=a(this).closest(d.parentSelector);e.length>0&&("before"===d.insertLocation?a("header",e).length>0?a("header",e).after(b):e.prepend(b):e.append(b))}switch(d.currentOperation){case"delete":b.lineitems("bindDeleteFormHandlers");break;default:b.lineitems("bindEditFormHandlers"),"function"==typeof d.callbacks.postContentInsert&&d.callbacks.postContentInsert.apply(b)}}})},bindNewItemHandlers:function(b){return this.each(function(){a(this).lineitems("bindActionHandler",b.edit)})},bindEditFormHandlers:function(c){var d=a.extend({},b,c||{});return this.each(function(){a(".datepicker",a(this)).datepicker(),a(this).lineitems("bindActionHandler",d.save),a(this).lineitems("bindActionHandler",d.del),a(this).lineitems("bindActionHandler",d.cancel)})},bindDeleteFormHandlers:function(d){var e=a.extend({},b,d||{});return this.each(function(){a(e.del.selector,a(this)).iconButton(e.del.button).off(e.del.event,c.commitDelete).on(e.del.event,c.commitDelete),a(this).lineitems("bindActionHandler",e.cancel)})},bindActionHandler:function(b){return this.each(function(){"click"===b.event&&a(b.selector,a(this)).iconButton(b.button),a(b.selector,a(this)).off(b.event,b.callback).on(b.event,b.callback)})},displayError:function(c,d){var e=a.extend({},b,d||{});return this.each(function(){var b=null;b=a(this).is("button")?a(this).closest(e.parentSelector):a(this);var d=a(e.errorSelector,b);d.length<1&&(a(this).prepend('<div class="alert '+e.errorSelector.replace(/^\./,"")+'"></div>'),d=a(e.errorSelector,a(this))),d.is(":visible")?d.slideToggle("fast",function(){a(this).html(c).slideToggle("slow")}):d.html(c).slideToggle("slow")})},displayStatus:function(c,d){var e=a.extend({},b,d||{});return this.each(function(){var b=a(e.statusSelector,a(this));b.length>0&&(b.is(":visible")?b.slideToggle("fast",function(){a(this).html(c).slideToggle("slow")}):b.html(c).slideToggle("slow"))})},resetMessages:function(b){return this.each(function(){var c=a(b.statusSelector,a(this)).is(":visible"),d=a(b.errorSelector,a(this)).is(":visible");c.length>0&&c.slideToggle("fast"),d.length>0&&d.slideToggle("fast")})}};a.fn.lineitems=function(b){if("extendMethods"===b)a.extend(!0,c,arguments[1]);else{if(c[b])return c[b].apply(this,Array.prototype.slice.call(arguments,1));if("object"==typeof b||!b)return c.init.apply(this,arguments);a.error("Method "+b+" does not exist on jQuery.lineitems.")}return!1}}(jQuery),function(a){var b={displayWarnings:!0,inlineOps:{nameURL:"_ajax/utils/edit_name.php",dateURL:"_ajax/utils/edit_date.php",accessURL:"_ajax/utils/edit_access.php",slotURL:"_ajax/utils/edit_slot.php",pageURL:"_ajax/utils/edit_page.php",statusURL:"_ajax/utils/edit_status.php"},uris:{edit_name:"",record_details:"details.php"},listingsContainer:"[deprecated]",pagesContainer:"[deprecated]",errorContainer:"[deprecated]",statusContainer:"[deprecated]",filtersSelector:"[deprecated]",sortableSelector:"[deprecated]",keys:{record_id:"id",parent_id:"pid",content_type:"tid",page:"p",operation:"op",csrf:"csrf"},dom:{listings_container:".listings",pages_container:".pages-container",page_error_container:".alert-error:first",error_container:".alert-error",status_container:".alert-info:first",filters_form:".listings-filters:first form",sortable_selector:"tr.rec-row",csrfSelector:"#csrf-token"}},c={bindListingsHandlers:function(d){var e=a.extend(!0,{},b,d||{});
return this.each(function(){a(this).off("contentUpdate",c.listingsUpdateCB).on("contentUpdate",e,c.listingsUpdateCB).off("dblclick",".inline-edit-cell",c.editCell).on("dblclick",".inline-edit-cell",d,c.editCell).off("click",".page-btn",c.gotoPage).on("click",".page-btn",d,c.gotoPage).off("click",".details-cell",c.gotoDetailsPage).on("click",".details-cell",d,c.gotoDetailsPage).off("click","button.update-cache-btn",a.littled.updateCache).on("click","button.update-cache-btn",{errorContainer:e.dom.error_container,statusContainer:e.dom.status_container},a.littled.updateCache),a("button.edit-btn",a(this)).formDialog("cancel",d).formDialog(d),a("button.trash-btn",a(this)).formDialog("cancel",d).formDialog(a.extend({},d,{dialogClass:"ui-dialog-delete"})),a(".edit-btn",a(this)).iconButton("edit"),a(".details-btn",a(this)).iconButton("details"),a(".preview-btn",a(this)).iconButton("link"),a(".print-btn",a(this)).iconButton("print"),a(".update-cache-btn",a(this)).iconButton("cache"),a(".trash-btn",a(this)).iconButton("trash")})},listingsUpdateCB:function(b){a(this).listings("bindListingsHandlers",b.data||{})},editCell:function(d){d.preventDefault();var e=a.extend(!0,{},b,d.data||{}),f=a(this).parent(),g=a(this).data(e.keys.operation),h={t:a(this).data("t")};h[e.keys.record_id]=a(this).data(e.keys.record_id),h[e.keys.operation]=g,h[e.keys.csrf]=a(e.dom.csrfSelector).html();var i=c.getInlineURL(g,d.data||{});a.post(i,h,function(b){return b.error?(a(e.dom.error_container).littled("displayError",b.error),void 0):(f.html(a.littled.htmldecode(b.content)),f.listings("bindEditHandlers"),"date"===g&&a(".datepicker",f).datepicker({onClose:c.saveEdit}),void 0)},"json").fail(function(b){a(e.dom.error_container).littled("ajaxError",b)})},bindEditHandlers:function(){return this.each(function(){a("input[type=text],input[type=number]",a(this)).off("keyup",c.testKeyedEntry).off("keypress",c.testKeyedEntry).off("commit",c.saveEdit).on("keyup",c.testKeyedEntry).on("keypress",c.testKeyedEntry).on("commit",c.saveEdit),a("select",a(this)).off("change",c.saveEdit).on("change",c.saveEdit)})},testKeyedEntry:function(d){var e=a(this).data("id"),f=a(this).data("t"),g=a(this).data("op"),h=a(this).closest(".inline-edit-cell").parent(),i=window.event?window.event.keyCode:d.which;switch(i){case 13:d.preventDefault(),a(this).trigger("commit");break;case 27:d.preventDefault();var j=c.getInlineURL(g);a.ajax({type:"get",url:j,data:{id:e,t:f,op:g,cancel:1},dataType:"json",success:function(c){return c.error?(a(b.dom.error_container).littled("displayError",c.error),void 0):(h.html(a.littled.htmldecode(c.content)),void 0)},error:function(c){a(b.dom.error_container).littled("ajaxError",c)}})}},saveEdit:function(d){var e=a.extend({},b,d||{}),f=a(this).data("op"),g=a(this).closest("form"),h=a(this).closest(".inline-edit-cell").parent(),i=c.getInlineURL(f,d);a.ajax({type:"post",url:i,data:g.serializeObject(),dataType:"json",success:function(b){return b.error?(a(e.dom.error_container).littled("displayError",b.error),void 0):(h.html(a.littled.htmldecode(b.content)),a(".inline-edit-cell",h).off("dblclick",c.editCell).on("dblclick",c.editCell),void 0)},error:function(b){a(e.dom.error_container).littled("ajaxError",b)}})},getInlineURL:function(c,d){var e,f=a.extend({},b,d||{});switch(c){case"name":e=a.littled.getRelativePath()+f.inlineOps.nameURL;break;case"date":e=a.littled.getRelativePath()+f.inlineOps.dateURL;break;case"access":e=a.littled.getRelativePath()+f.inlineOps.accessURL;break;case"slot":e=a.littled.getRelativePath()+f.inlineOps.slotURL;break;case"page":e=a.littled.getRelativePath()+f.inlineOps.pageURL;break;case"status":e=a.littled.getRelativePath()+f.inlineOps.statusURL;break;default:a(b.dom.error_container).littled("displayError","Invalid operation: "+c)}return e},saveDate:function(c){var d=c.data||{},e=a.extend(!0,{},b,d),f=a(this).parents("form:first");a.post(a.littled.getRelativePath()+b.date_url,f.serializeObject(),function(b){b.settings=d,a(e.dom.listings_container).listings("updateListingsContent",b)},"json").fail(function(b){a(e.dom.page_error_container).littled("ajaxError",b)})},updateListingsContent:function(c){var d=a.extend(!0,{},b,c.settings||{});if(c.error)return a(d.dom.error_container).littled("displayError",c.error),void 0;var e=d.dom.listings_container||c.container_id,f=a(e);f.length>0?f.html(a.littled.htmldecode(c.content)).triggerHandler("contentUpdate"):d.displayWarnings===!0&&a(d.dom.error_container).littled("displayError",'Content container not found: "'+e+'"'),a(d.dom.status_container).littled("displayStatus",c.status)},gotoPage:function(d){d.preventDefault();var e=d.data||{},f=a.extend(!0,{},b,e);a(f.dom.status_container).fadeOut("fast");var g=a(f.dom.listings_container),h=a(f.dom.filters_form).littled("collectFormDataWithCSRF",d.data||{});h[f.keys.page]=a(this).data(f.keys.page),h[f.keys.content_type]=a("table:first",g).data(f.keys.content_type),h[f.keys.parent_id]=a("table:first",g).data(f.keys.parent_id),a.littled.retrieveContentOperations(h[f.keys.content_type],function(b){return b.error?(a(f.dom.page_error_container).littled("displayError",b.error),void 0):b.listings_uri?(a.post(b.listings_uri,h,function(b){return b.error?(a(f.dom.page_error_container).littled("displayError",b.error),void 0):(a(f.dom.listings_container).littled("displayAjaxResult",b).triggerHandler("contentUpdate"),c.updateNavigationValue(f.keys.page,h[f.keys.page],e),void 0)},"json").fail(function(b){a(f.dom.page_error_container).littled("ajaxError",b)}),void 0):(a(f.dom.page_error_container).littled("displayError","Handler not defined."),void 0)})},gotoDetailsPage:function(c){c.preventDefault();var d=a.extend(!0,{},b,c.data||{}),e=a(this).data(d.keys.record_id);if(!e)return a(this).closest(d.dom.error_container).littled("displayError","A record id was not provided."),void 0;if(""===d.uris.record_details)return a(this).closest(d.dom.error_container).littled("displayError","An URI was not provided."),void 0;var f=d.uris.record_details+"?"+d.keys.record_id+"="+e+"&"+a(d.dom.filters_form).serialize();window.location=f},updateNavigationValue:function(c,d,e){var f,g=(a.extend(!0,{},b,e||{}),window.location.href),h=new RegExp("([?|&])"+c+"=.*?(&|$)","i");f=g.match(h)?g.replace(h,"$1"+c+"="+d+"$2"):g+(g.indexOf("?")>0?"&":"?")+c+"="+d,history.pushState(null,null,f)},bindKeyPageNavigation:function(a){return this.on("keydown",function(b){var c=b.keyCode||b.which,d={left:37,up:38,right:39,down:40};switch(c){case d.left:a.hasOwnProperty("leftKeyURL")&&a.leftKeyURL&&(window.location=a.leftKeyURL);break;case d.right:a.hasOwnProperty("rightKeyURL")&&a.rightKeyURL&&(window.location=a.rightKeyURL);break;case d.up:a.hasOwnProperty("upKeyURL")&&a.upKeyURL&&(window.location=a.upKeyURL);break;case d.down:a.hasOwnProperty("downKeyURL")&&a.downKeyURL&&(window.location=a.downKeyURL)}})}};a.fn.listings=function(b){return c[b]?c[b].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof b&&b?(a.error("Method "+b+" does not exist on jQuery.listings."),!1):c.init.apply(this,arguments)}}(jQuery),function(a){var b={progressMarkup:'<div class="dialog-in-process"></div>',parentContainer:".kw-container",contentContainer:".kw-cell",errorContainer:".alert-error",statusContainer:".kw-status-container",csrfSelector:"#csrf-token"},c={bindListingsHandlers:function(b){return this.each(function(){a(this).off("contentUpdate",c.updateListingsHandlers).on("contentUpdate",b,c.updateListingsHandlers).off("click",".edit-kw-btn",c.edit).on("click",".edit-kw-btn",b,c.edit).off("click",".kw-commit-btn",c.save).off("click",".kw-cancel-btn",c.cancel).on("click",".kw-commit-btn",b,c.save).on("click",".kw-cancel-btn",b,c.cancel),a(".edit-kw-btn",a(this)).iconButton("edit")})},updateListingsHandlers:function(b){a(this).keywords("bindListingsHandlers",b.data||{})},bindEditButtons:function(){return this.each(function(){var b=a("textarea",a(this));b.height(b.prop("scrollHeight")),a(".kw-commit-btn",a(this)).iconButton("circle-check"),a(".kw-cancel-btn",a(this)).iconButton("circle-close")})},edit:function(c){c.preventDefault(),c.stopPropagation();var d=a.extend(!0,{},b,c.data||{});a(d.errorContainer+":visible").slideToggle("fast");var e=a(this).closest(d.parentContainer),f=a(this).data("id"),g=a(this).data("tid");return g?(a.littled.retrieveContentOperations(g,function(b){if(b.error)return a(d.errorContainer).littled("displayError",b.error),void 0;if(!b.keywords_uri)return a(d.errorContainer).littled("displayError","Handler not set."),void 0;var c={csrf:a(d.csrfSelector).html(),kwpi:f,kwti:g};a.post(b.keywords_uri,c,function(a){a.settings=d,e.keywords("updateKeywordContent",a,function(){e.keywords("bindEditButtons")})},"json").fail(function(a){e.littled("ajaxError",a)}),e.keywords("displayProcessWheel")}),void 0):(a(d.errorContainer).littled("displayError","Content type not set."),void 0)},displayError:function(c,d){var e=a.extend(!0,{},b,d||{});return this.each(function(){a(this).keywords("hideProcessWheel"),a(e.errorContainer,a(this)).littled("displayError",c)})},save:function(c){c.preventDefault();var d=a.extend(!0,{},b,c.data||{});a(d.errorContainer+":visible").slideToggle("fast");var e=a(this).closest(d.parentContainer),f=a(this).parents("form:first"),g=a(this).data("tid");a.littled.retrieveContentOperations(g,function(b){var c=f.serializeObject({csrf:a(d.csrfSelector).html()});a.post(b.keywords_uri,c,function(a){a.settings=d,e.keywords("updateKeywordContent",a,function(){e.trigger("contentUpdate")})},"json").fail(function(a){e.littled("ajaxError",a)})})},cancel:function(c){c.preventDefault();var d=a.extend(!0,{},b,c.data||{}),e=a(this).closest(d.parentContainer),f=a(this).parents("form:first"),g=a(this).data("tid");a(this).formDialog("retrieveContentOperations",g,function(b){var c={cancel:"1",csrf:a(d.csrfSelector).html()},g=f.serializeObject(c,["commit"]);a.post(b.keywords_uri,g,function(a){a.settings=d,e.keywords("updateKeywordContent",a,function(){e.trigger("contentUpdate")})},"json").fail(function(a){e.littled("ajaxError",a)})})},updateKeywordContent:function(c,d){var e=a.extend(!0,{},b,c.settings||{});return this.each(function(){if(c.error)return a(e.errorContainer,a(this)).littled("displayError",c.error),void 0;a(e.errorContainer+":visible",a(this)).hide(),a(e.statusContainer+":visible",a(this)).hide();var b=a(e.contentContainer,a(this));b.length>0?b.html(a.littled.htmldecode(c.content)):a(this).keywords("displayError","Keyword container ("+e.contentContainer+") not found. "),"function"==typeof d&&d()})},displayProcessWheel:function(c){var d=a.extend(!0,{},b,c||{});return this.each(function(){a(d.errorContainer,a(this)).fadeOut("fast"),a(d.statusContainer,a(this)).fadeIn("slow").html(d.progressMarkup)})},hideProcessWheel:function(c){var d=a.extend({},b,c||{});return this.each(function(){a(d.statusContainer,a(this)).fadeOut("fast")})}};a.fn.keywords=function(b){return c[b]?c[b].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof b&&b?(a.error("Method "+b+" does not exist on jQuery.listings."),void 0):c.init.apply(this,arguments)}}(jQuery),function(a){var b={uris:{keyword_autocomplete:"_ajax/utils/keyword_autocomplete.php",record_details:"details.php"},keys:{record_id:"id",parent_id:"pid",content_type:"tid",page:"p",operation:"op",csrf:"csrf"},dom:{listings_container:".listings",page_error_container:".alert-error:first",error_container:".alert-error",filters_form:".listings-filters:first form",csrf_selelctor:"#csrf-token"},selectCallback:null},c={bindAutocomplete:function(d){var e=a.extend(!0,{},b,d||{});return"function"!=typeof e.selectCallback&&(e.selectCallback=c.selectCallback),this.each(function(){var b=a(this).prop("name"),c={};c[e.keys.content_type]=a(this).data(e.keys.content_type),c[e.keys.csrf]=a(e.dom.csrf_selector).html(),a(this).autocomplete({minLength:3,source:function(d,f){c[b]=d.term,a.ajax({type:"post",url:a.littled.getRelativePath()+e.uris.keyword_autocomplete,data:c,dataType:"json"}).success(function(b){return b.error?(a(e.dom.page_error_container).littled("displayError",b.error),void 0):(f(a.map(b,function(a){return{item:a.id,label:a.title,value:a.id,term:d.term}})),void 0)}).fail(function(b){a(e.dom.page_error_container).littled("ajaxError",b)})},select:e.selectCallback})})},selectCallback:function(c,d){var e=a.extend(!0,{},b,c.data||{});c.preventDefault(),a(this).val(d.item.term+"*");var f=d.item.value,g=a(e.dom.filters_form).serializeArray(),h=a.map(g,function(a){return a.name+"="+encodeURIComponent(a.value)}),i=e.uris.record_details+"?"+h.join("&")+"&id="+f;window.location=i}};a.fn.keywordFilter=function(b){return c[b]?c[b].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof b&&b?(a.error("Method "+b+" does not exist on jQuery.keywordFilter."),!1):c.init.apply(this,arguments)}}(jQuery),function(a){var b={uris:{resort:"/_ajax/utils.resort.php"},dom:{listings_container:".listings",sortable_selector:"tr.rec-row",status_container:".alert-info:first",page_error_container:".alert-error:first",error_container:".alert-error",filters_form:".listings-filters:first form",csrf_selector:"#csrf-token"},keys:{record_id:"id",parent_id:"pid",content_type:"tid",page_size:"pl",position_offset:"po",operation:"op",csrf:"csrf"}},c={init:function(c){var d=a.extend(!0,{},b,c||{});return this.each(function(){a(this).sortable({items:d.dom.sortable_selector,start:function(b,c){a(d.dom.status_container+":visible").fadeOut("fast");var e=c.helper.data("rid");if(e){var f=a("#pages-row-"+e);f.length<1||f.is("visible")&&(f.addClass("reopen"),f.hide())}},update:function(b,d){b.data=c,a(this).resort("resort",b,d)}})})},bindResort:function(){return c.init.apply(this,arguments)},resort:function(c,d){var e=c.data||{},f=a.extend(!0,{},b,e);return this.each(function(){a(f.dom.page_error_container).hide();var b=d.item.attr("id");b&&(b="#"+b),a(this).resort("refreshSortableRowStyles",b),a(this).sortable("disable"),a(this).parent().children(".progress-msg").show().position({my:"center",at:"center",of:a(this).parent()});var c=a(this).data(f.keys.content_type),g=a(this).data(f.keys.position_offset);if(void 0===c||void 0===g)return a(f.dom.page_error_container).littled("displayError","Section id or page offset values not set!"),a(this).resort("rollbackSort",b),void 0;var h=new Array,i=a(this).sortable("toArray");if(i.length>0){var j;for(var k in i)i[k]&&(j=a("#"+i[k]).data("rid"),parseInt(j)>0&&h.push(j))}if(h.length<1)return a(this).resort("rollbackSort",b),void 0;var l=a(this);a.littled.retrieveContentOperations(c,function(d){if(d.error)return a(f.dom.page_error_container).littled("displayError",d.error),void 0;if(!d.sorting_uri)return a(f.dom.page_error_container).littled("displayError","Handler not defined."),void 0;var i={},j=a(f.dom.filters_form);j.length>0&&(i=j.littled("collectFormDataWithCSRF",f));var k={ssid:c,rid:b};k[f.keys.parent_id]=a(this).data(f.keys.parent_id),k[f.keys.record_id]=JSON.stringify(h),k[f.keys.position_offset]=g,a.extend(i,k),a.post(d.sorting_uri,i,function(a){a.settings=e||{},l.resort("onResortComplete",a)},"json").fail(function(b){a(f.dom.page_error_container).littled("ajaxError",b)})})})},refreshSortableRowStyles:function(b){return this.each(function(){if(a(this).is("table")!==!1&&(a("tr.rec-row:odd",a(this)).removeClass("list list-alt").addClass("list"),a("tr.rec-row:even",a(this)).removeClass("list list-alt").addClass("list-alt"),a("tr.page-row:odd",a(this)).removeClass("list list-alt").addClass("list"),a("tr.page-row:even",a(this)).removeClass("list list-alt").addClass("list-alt"),b)){var c=a(b);if(c.length<1)return;var d=c.prev();if(d.length<0)return;var e=d.data("rid"),f=a("#pages-row-"+e);if(f.length>0&&f.is(":hidden")&&f.insertAfter(d),e=c.data("rid"),f=a("#pages-row-"+e),f.length<1)return;f.insertAfter(c),f.hasClass("reopen")&&(f.slideToggle(),f.removeClass("reopen"))}})},onResortComplete:function(c){var d=c.settings||{},e=a.extend(!0,{},b,d);return this.each(function(){return a(this).parent().children(".progress-msg").hide(),c.error?(a(this).resort("rollbackSort",c.id),a(e.dom.page_error_container).littled("displayError",c.error),void 0):(a(this).resort("refreshSortableRowStyles").sortable("enable"),c.status&&a(e.dom.status_container).littled("displayStatus",c.status),void 0)})},onResortFailure:function(c,d){var e=a.extend({},b,d||{});return a(e.dom.page_error_container).littled("displayError",c.responseText),this.each(function(){a(this).parent().children(".progress-msg").hide(),a(this).sortable("enable")})},rollbackSort:function(b,c){return c&&c.hide(),this.each(function(){a(this).sortable("cancel").sortable("enable").resort("refreshSortableRowStyles",b)})}};a.fn.resort=function(b){return c[b]?c[b].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof b&&b?(a.error("Method "+b+" does not exist on jQuery.resort."),!1):c.init.apply(this,arguments)}}(jQuery);